<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Product | Livora Furniture</title>
  <meta name="description" content="Livora Furniture — Designed for Better Living. Luxury classic sofas, beds, dining and more. Islandwide delivery in Sri Lanka."/>
  <link rel="icon" href="assets/logo.png"/>
  <link rel="stylesheet" href="assets/css/styles.css"/>
</head>
<body>
  <header class="nav">
    <div class="nav-inner">
      <a class="brand" href="index.html" aria-label="Livora Furniture Home">
        <img src="assets/logo.png" alt="Livora Furniture logo"/>
        <div>
          <div class="title">Livora Furniture</div>
          <div class="tag">Designed for Better Living</div>
        </div>
      </a>

      <nav class="nav-links" aria-label="Site">
        <a href="index.html">Home</a>
        <a href="shop.html">Shop</a>
        <a href="gallery.html">Gallery</a>
        <a href="reviews.html">Reviews</a>
        <a href="faq.html">FAQ</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
        <a class="pill secondary" href="cart.html">Cart (<span data-cart-count>0</span>)</a>
        <a class="pill" href="https://wa.me/94717227327" target="_blank" rel="noopener">WhatsApp</a>
      </nav>
    </div>
  </header>

  <main class="container">
    
<div class="section-title">
  <div>
    <h2 id="pName">Product</h2>
    <p id="pMeta" class="small"></p>
  </div>
  <a class="pill secondary" href="shop.html">Back to Shop</a>
</div>

<section class="row">
  <div class="panel">
    <div class="gallery">
      <img id="pImg1" src="products/images/teal-modern-set.jpg" alt="Product image"/>
      <img id="pImg2" src="products/images/blue-modern-set.jpg" alt="Product image"/>
    </div>

    <div style="margin-top:14px" class="notice" id="pDelivery"></div>

    <div style="margin-top:14px" class="btnrow">
      <a class="btn primary" id="waBtn" href="#">WhatsApp</a>
      <a class="btn" href="tel:0717227327">Call</a>
      <button class="btn" id="addBtn">Add to Cart</button>
    </div>
  </div>

  <div class="panel">
    <div class="meta" style="align-items:flex-start">
      <div>
        <div class="chip" id="pCategory">Category</div>
        <div style="margin-top:10px">
          <div class="small">Price</div>
          <div class="price" id="pPrice" style="font-size:26px"></div>
        </div>
      </div>
      <div class="small" id="pStock"></div>
    </div>

    <div style="margin-top:14px">
      <label class="small" for="sizeSelect">Size</label><br/>
      <select id="sizeSelect" class="select" style="width:100%"></select>
    </div>

    <div style="margin-top:12px">
      <label class="small" for="colorSelect">Color</label><br/>
      <select id="colorSelect" class="select" style="width:100%"></select>
    </div>

    <div style="margin-top:14px">
      <div class="small" style="margin-bottom:8px">Highlights</div>
      <ul id="pHighlights" style="margin:0; padding-left:18px;"></ul>
    </div>

    <div style="margin-top:16px" class="notice">
      <strong>Online orders:</strong> Add to cart and checkout to send your order via WhatsApp. Payments handled after contact.
    </div>
  </div>
</section>

<script>
(async () => {
  const params = new URLSearchParams(location.search);
  const id = params.get("id");
  const products = await loadProducts();
  const p = products.find(x=>x.id===id) || products[0];

  document.getElementById("pName").textContent = p.name;
  document.getElementById("pMeta").textContent = `${p.category} • ${p.type}`;
  document.getElementById("pCategory").textContent = p.category;
  document.getElementById("pPrice").textContent = formatLKR(p.priceLKR);
  document.getElementById("pStock").textContent = "Stock: " + p.stockStatus.replaceAll("_"," ");
  document.getElementById("pDelivery").textContent = "Delivery: " + p.delivery;

  const img1 = document.getElementById("pImg1");
  const img2 = document.getElementById("pImg2");
  img1.src = p.images[0] || img1.src;
  img2.src = (p.images[1] || p.images[0] || img2.src);

  const sizeSelect = document.getElementById("sizeSelect");
  sizeSelect.innerHTML = p.sizes.map(s=>`<option value="${s}">${s}</option>`).join("");

  const colorSelect = document.getElementById("colorSelect");
  colorSelect.innerHTML = p.colors.map(c=>`<option value="${c}">${c}</option>`).join("");

  const ul = document.getElementById("pHighlights");
  ul.innerHTML = p.highlights.map(h=>`<li>${h}</li>`).join("");

  function updateWA(){
    const size = sizeSelect.value;
    const color = colorSelect.value;
    const msg = encodeURIComponent(
      `Hi Livora Furniture, I'm interested in:
` +
      `${p.name}
` +
      `Size: ${size}
Color: ${color}
Price: ${formatLKR(p.priceLKR)}

` +
      `Please confirm availability and delivery time.`
    );
    const url = `${LIVORA.whatsappBase}?text=${msg}`;
    const waBtn = document.getElementById("waBtn");
    waBtn.href = url;
    waBtn.target = "_blank";
    waBtn.rel = "noopener";
  }

  sizeSelect.addEventListener("change", updateWA);
  colorSelect.addEventListener("change", updateWA);
  updateWA();

  document.getElementById("addBtn").addEventListener("click", () => {
    addToCart({
      id: p.id,
      name: p.name,
      priceLKR: p.priceLKR,
      size: sizeSelect.value,
      color: colorSelect.value,
      qty: 1,
      image: p.images[0] || ""
    });
    const btn = document.getElementById("addBtn");
    btn.textContent = "Added ✓";
    setTimeout(()=>btn.textContent="Add to Cart", 1200);
  });
})().catch(console.error);
</script>

  </main>

  <footer class="footer">
    <div class="footer-inner">
      <div>
        <strong>Livora Furniture</strong><br/>
        <small>Designed for Better Living</small><br/>
        <small>Islandwide delivery available • Sri Lanka</small>
      </div>
      <div>
        <a href="delivery.html">Delivery & Warranty</a>
        <a href="contact.html">Contact</a>
        <a href="shop.html">Shop</a>
      </div>
      <div>
        <small>WhatsApp / Call: <a href="tel:0717227327">0717227327</a></small><br/>
        <small>Email: <a href="mailto:furniturelivora@gmail.com">furniturelivora@gmail.com</a></small>
      </div>
    </div>
  </footer>

  <a class="fab" href="https://wa.me/94717227327" target="_blank" rel="noopener" aria-label="Chat on WhatsApp">WhatsApp</a>

  <script src="assets/js/app.js"></script>
</body>
</html>